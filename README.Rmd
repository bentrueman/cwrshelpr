---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
) 
```

# cwrshelpr

<!-- badges: start -->
<!-- badges: end -->

`cwrshelpr` provides a collection of functions for data analysis tasks at Dalhousie University's Centre for Water Resources Studies.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("remotes")
remotes::install_github("bentrueman/cwrshelpr")
```
## Read and clean ICP-MS data

To read and clean ICP-MS data files generated by the Thermo Scientific iCAP-RQ, use the `read_icp()` function. (N.B., the code below uses external raw data files as examples; replace them with your data.)

```{r read-icp, message=FALSE}
library("tidyverse")
library("cwrshelpr")
# example path to example raw data file
files <- list.files(
   path = system.file("extdata", package = "cwrshelpr"), # replace this line with the path to your data
   full.names = TRUE,
   pattern = ".+\\.xlsx"
)
read_icp(path = files[1]) # read and clean one file
files %>% 
  set_names() %>% 
  map_dfr(read_icp, .id = "file") # read and clean multiple files

```

## Read and clean FEEM data

To read and clean FEEM data files generated by the Horiba Aqualog, use the `read_feem()` function.

```{r read-feem, message=FALSE}

files <- list.files(
   path = system.file("extdata", package = "cwrshelpr"), # replace this line with the path to your data
   full.names = TRUE,
   pattern = ".+\\.csv"
)
read_feem(path = files[1]) # read and clean one file
feem_dat <- files %>% 
  set_names() %>% 
  map_dfr(read_feem, .id = "file") # read and clean multiple files

```

Plot FEEM data using `ggplot2::geom_raster()`. Use the column `em_regular` to avoid horizontal striping due to irregular spacing of the `emission` wavelengths.

```{r feem-plot}

feem_dat %>% 
  ggplot(aes(excitation, em_regular, fill = intensity)) +
  facet_wrap(vars(file)) + 
  geom_raster()

```


